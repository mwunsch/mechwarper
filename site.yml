---
- hosts: all
  remote_user: freebsd
  gather_facts: no
  become: true
  tasks:
    - name: install python
      raw: pkg info -e python || env ASSUME_ALWAYS_YES=YES pkg install python
      register: result
      changed_when: result.stdout != ""

- hosts: all
  remote_user: freebsd
  become: true
  tasks:
    - name: install bash
      pkgng: name=bash state=present
    - name: mount fdesc
      # we ensure fdescfs(5) is mounted for bash process substitution
      mount: src=fdesc name=/dev/fd fstype=fdescfs opts=rw state=mounted
    - name: install git
      pkgng: name=git state=present
    - name: install stow
      pkgng: name=stow state=present
    - name: install hub
      pkgng: name=hub state=present
    - name: install rbenv
      pkgng: name=rbenv state=present
    - name: install emacs
      pkgng: name=emacs-nox11 state=present
    - name: add mw user
      user: name=mw groups=wheel shell=/usr/local/bin/bash append=yes
